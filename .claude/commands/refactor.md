Refactor the specified code following these principles:

1. **Maintain Functionality**: Preserve all existing behavior
2. **Improve Readability**: Make code more understandable
3. **Enhance Performance**: Optimize where beneficial
4. **Follow Best Practices**: Apply modern coding standards
5. **Ensure Testability**: Make code easier to test

Provide before/after comparisons and explain changes.